# Product Database – Server

This is the **API Server** for the Product Database. It is built with Go and provides a RESTful JSON API for managing product data.

---

## Technologies Used

- **Go 1.24+**
- [**Fuego**](https://github.com/go-fuego/fuego) – lightweight HTTP framework
- [**GORM**](https://gorm.io/) – ORM for PostgreSQL, SQLite, etc.
- [**go-playground/validator**](https://github.com/go-playground/validator) – request validation
- [**Air**](https://github.com/cosmtrek/air) – live reload during development

---

## Structure

```
server/
├── cmd/server         # Main entry point
├── internal/          # Feature modules (product, db, config, etc.)
├── doc/              # OpenAPI specification (generated)
├── Makefile
└── go.mod / go.sum
```

---

## Getting Started

### Prerequisites

- [Go](https://golang.org/dl/) 1.24 or higher

### Setup

```sh
# Install dependencies
$ go mod tidy

# Install developer tools (air, lint, etc.)
$ make tools

# Copy .env.sample to .env and edit as needed
$ cp .env.sample .env

# Start the development server
$ make dev
```

---

## Development Commands

| Command      | Description                                |
| ------------ | ------------------------------------------ |
| `make dev`   | Start the server with **Air** (hot reload) |
| `make run`   | Run the server once without reload         |
| `make test`  | Run unit tests with race detector          |
| `make fmt`   | Run `gofmt` on all source files            |
| `make build` | Build a production binary in `./bin/`      |
| `make clean` | Remove the binary and temp files           |

---

## OpenAPI Specification

The API is fully documented via **OpenAPI**, automatically generated by Fuego.

After running the server, you can find the spec at:

```
http://localhost:9999/swagger/openapi.json
```

You can also access the interactive Swagger UI at:

```
http://localhost:9999/swagger/
```

The specification is also available in the `doc/` directory as `openapi.json` and can be used for automatic generation of client libraries.

---

## Deployment

To build a binary for deployment:

```sh
make build
```

The binary will be available at `./bin/server`.

## Environment Variables

The following environment variables can be configured:

| Variable        | Required | Default       | Description                                                  |
| --------------- | -------- | ------------- | ------------------------------------------------------------ |
| `HOST`          | No       | `0.0.0.0`     | The host address for the server to bind to                   |
| `PORT`          | No       | `9999`        | The port number for the server to listen on                  |
| `ENV`           | No       | `development` | The environment mode. Set to `production` to hide the Swagger UI |
| `CORS_ORIGIN`   | No       |               | Allowed CORS origins. Single origin: `http://localhost:3000` or multiple separated by commas: `http://localhost:3000,https://app.example.com,http://localhost:8081`. Use `*` to allow all origins (not recommended for production) |
| `DATABASE_PATH` | Yes      |               | Path to the SQLite database file                             |

